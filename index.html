<!DOCTYPE html>
<html lang="en">
<head>
	<script src="jquery-ui-1.11.2/external/jquery/jquery.js"></script>
	<script src="jquery-ui-1.11.2/jquery-ui.js"></script>
	<script src="tag-it/js/tag-it.min.js"></script>
	<script src="jQuery-ui-Slider-Pips-master/src/js/jquery-ui-slider-pips.js"></script>
	<script src="http://d3js.org/d3.v3.min.js" charset="utf-8"></script>

	<link href="jquery-ui-1.11.2/jquery-ui.css" rel="stylesheet">
	<link href="tag-it/css/jquery.tagit.css" rel="stylesheet" type="text/css">
    <link href="tag-it/css/tagit.ui-zendesk.css" rel="stylesheet" type="text/css">
	<link href="jQuery-ui-Slider-Pips-master/src/css/jquery-ui-slider-pips.css" rel="stylesheet" type="text/css">

	
	<style>
		html, body {
			height:100%;
			width:100%;
			margin:0px;
		}

		#filterAccordion > div {
			padding:15px;
		}

		#filters, results {
			padding:0px;
		}
	</style>
</head>
<body>
	<table id="PageLayout" style="width:100%; height:100%;">
		<tr height="15%">
			<td width="300px">
				<h1>Yelp</h1>
			</td>
			<td>
				Search: <input style="width:300px;" type="text">
			</td>
		</tr>
		<tr height="85%">
			<td width="300px">
				<div id="tabs" style="height:100%;">
					<ul>
						<li><a href="#filters">Filters</a></li>
						<li><a href="#results">Results</a></li>
					</ul>
					<div id="filters">
						<div id="filterAccordion">
							<h3>Location</h3>
							<div id="locationPanel"></div>
							<h3>Cost</h3>
							<div id="costPanel"></div>
							<h3>Cuisine</h3>
							<div id="cuisinePanel"></div>
							<h3>Ratings</h3>
							<div id="ratingsPanel">
								<legend>Customer Ratings</legend>
								<input type="checkbox" class="checkbox2"> <label>5 stars</label><br>
								<input type="checkbox" class="checkbox2"> <label>4 stars</label><br>
								<input type="checkbox" class="checkbox2"> <label>3 stars</label><br>
								<input type="checkbox" class="checkbox2"> <label>2 stars</label><br>
								<input type="checkbox" class="checkbox2"> <label>1 star</label><br>
							</div>
							<h3>Features</h3>
							<div id="featuresPanel">
								<legend>Restaurant Features</legend>
								<input type="checkbox" class="checkbox1"> <label>Accepts debit/credit</label><br>
								<input type="checkbox" class="checkbox1"> <label>Delivery</label><br>
								<input type="checkbox" class="checkbox1"> <label>Takes Reservations</label><br>
								<input type="checkbox" class="checkbox1"> <label>Wheelchair Accessible</label><br>
								<input type="checkbox" class="checkbox1"> <label>Good for Kids</label><br>
								<input type="checkbox" class="checkbox1"> <label>Good for Groups</label><br>
								<input type="checkbox" class="checkbox1"> <label>19+ Only</label><br>
								<input type="checkbox" class="checkbox1"> <label>Fast Food</label><br>
								<input type="checkbox" class="checkbox1"> <label>Organic/Locally Grown</label><br>
							</div>
						</div>
					</div>
					<div id="results">Big list of results</div>
				</div>
			</td>
			<td>
				<div style="width:100%; height:100%;">
					<img src="MapPic.png" style="border:0; position:absolute;">
					<svg style="position:absolute;">
						<circle id="radius" fill-opacity="0" cx="50%" cy="50%" r="40" stroke="red" stroke-width="1" fill="red" style="cursor:move;"/>
					</svg>
				</div>
			</td>
		</tr>
	</table>

	<script>
		// Set up the map size
		$( document ).ready(function() {
			$("img").css("width", $("img").parent().width())
			$("img").css("height", $("img").parent().height())
			$("svg").css("width", $("svg").parent().width())
			$("svg").css("height", $("svg").parent().height())
		});
		$(window).resize(function(){
			$("img").css("width", $("img").parent().width())
			$("img").css("height", $("img").parent().height())
			$("img").css("width", $("svg").parent().width())
			$("img").css("height", $("svg").parent().height())
		});

		// Set up the circle events
		var beingDragged = false
		$('#radius').mousedown(function(event){
			beingDragged = true
		})
		$('svg').mousemove(function(event){
			offsetX = event.offsetX + $("#radius").position().left
			offsetY = event.offsetY + $("#radius").position().top
			if (beingDragged){
				$("#radius").attr('cx', event.offsetX)
				$("#radius").attr('cy', event.offsetY)
			}
		})
		$('body').mouseup(function(event){
			beingDragged = false
		})

		makeLocationSearchWidget()
		makeLocationRadiusWidget()
		makeCostWidget()
		makeCuisineWidget()
		makeRatingsWidget()
		$("#tabs").tabs();
		$("#filterAccordion").accordion({
			collapsible: true,
			heightStyle: "content"
		});
		makeDataPoints()

		function makeDataPoints(){
			// Generate data
			var restaurants = []
			var CuisineTypes = ["Indian, Chinese, Japanese, Sushu, Pizza, Italian, French"]
			for (i=0; i<100; i++){
				for (j=0; j<100; j++){
					var restaurant = {}
					restaurant["Cost"] = (i*100 + j) % 40
					restaurant["Location"] = [i, j]
					restaurant["Cuisine"] = CuisineTypes[(i*100 + j) % CuisineTypes.length]
					restaurant["Rating"] = ((i*100 + j) % 5) + 1
					restaurant["Features"] = {}
					restaurant["Features"]["Card"] = (i*100 + j) % 9 == 0 ? true : false
					restaurant["Features"]["Delivery"] = (i*100 + j) % 9 == 1 ? true : false
					restaurant["Features"]["Reservation"] = (i*100 + j) % 9 == 2 ? true : false
					restaurant["Features"]["Wheelchair"] = (i*100 + j) % 9 == 3 ? true : false
					restaurant["Features"]["Kids"] = (i*100 + j) % 9 == 4 ? true : false
					restaurant["Features"]["Group"] = (i*100 + j) % 9 == 5 ? true : false
					restaurant["Features"]["19+"] = (i*100 + j) % 9 == 6 ? true : false
					restaurant["Features"]["Fast"] = (i*100 + j) % 9 == 7 ? true : false
					restaurant["Features"]["Organic"] = (i*100 + j) % 9 == 8 ? true : false
					restaurants.push(restaurant)
				}
			}

			d3.select("svg")
				.selectAll("circle")
					.data(restaurants)
				.enter().append("circle")
				.attr("fill-opacity", "1")
				.attr("cx", function (d){
					return d["Location"][0] + "%"
				})
				.attr("cy", function (d){
					return d["Location"][1] + "%"
				})
				.attr("r", "1")
				.attr("stroke", "red")
				.attr("stroke-width", "1")
				.attr("fill", "red")
				.attr("attributes", function (d) { return d })
		}

		function makeWidgetLabel(panel, label){
			$("#" + panel).append('<div style="margin:0px 0px 10px 0px">' + label + '</div>')
		}

		function makeCostWidget(){
			makeWidgetLabel("costPanel", "Average Price of Main Plate")

			// Make the div which will hold the min max labels and the slider
			$("#costPanel").append('<div class="slider" style="margin: 0px 5px 20px 10px;"></div>')
				
			$(".slider").slider({
				max: 30,
				min: 0,
				range: true,
				step: 5,
				values: [5, 20],
				slide: function(event, ui){
					$("#sliderMin").text(ui.values[0])
					$("#sliderMax").text(ui.values[1])
				}
			});
			$(".slider").slider('pips');
			$(".slider").slider('float');
		};

		function makeCuisineWidget(){
			makeWidgetLabel("cuisinePanel", "Cuisine Preference")

			var options = ["Chinese", "Mexican", "Indian", "Japanese", "French", "Italian"]
			$("#cuisinePanel").append("<ul></ul>")
			$("#cuisinePanel > ul").tagit({
				availableTags: options,
				autocomplete: {delay: 0, minLength: 1, autoFocus: true},
				beforeTagAdded: function(event, ui){
					if (options.indexOf(ui.tagLabel) != -1){
						return true
					}else{
						return false
					}
				}
			})
		};

		function makeLocationSearchWidget() {
			makeWidgetLabel("locationPanel", "Where do you want to eat?")

			//search bar
			var options = ["UBC", "Point Grey", "Kitsilano", "Dunbar", "Arbutus", "Kerrisdale"]
			$("#locationPanel").append("<ul></ul>")
			$("#locationPanel > ul").tagit({
				availableTags: options,
				autocomplete: {delay: 0, minLength: 1, autoFocus: true},
				beforeTagAdded: function(event, ui){
					if (options.indexOf(ui.tagLabel) != -1){
						return true
					}else{
						return false
					}
				}
			});
		};

		function makeLocationRadiusWidget() {
			//radius slider bar
			makeWidgetLabel("locationPanel", "Distance from Restaurant")

			$("#locationPanel").append('<div class="sliderL" style="margin: 0px 5px 20px 10px;"></div>')

			$(".sliderL").slider({
				max: 30,
				value: 15,
				step: 5
				
			});
			$(".sliderL").slider('pips');
			$(".sliderL").slider('float');
		}
			
				

		function makeRatingsWidget(){
			//makeWidgetLabel("ratingsPanel", "Customer Ratings")

			//$('.checkbox2').checkator();

			// 5, 4, 3, 2, 1 star options
			// options as check boxes
		};


	</script>

</body>
</html>